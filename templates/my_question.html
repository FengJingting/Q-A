{% extends "base.html" %}

{% block title %}Mine{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{{ url_for('static',filename='css/index.css') }}">
{% endblock %}


{% block body %}
    <div class="row" style="margin-top: 20px;">
        <div class="col"></div>
            <div class="col-8">
                <ul class=" nav nav-tabs mb-4 pb-2" id="ex1" role="tablist">
                    <li class="nav-item nav-mid shade" role="presentation">
                        <a class="nav-link" id="ex1-tab-1" data-mdb-toggle="tab" href="{{ url_for('mine.see_my_info') }}" role="tab" aria-controls="ex1-tabs-1" aria-selected="true">
                            Personal Info
                        </a>
                    </li>
                    <li class="nav-item nav-mid shade" role="presentation">
                        <a class="nav-link" id="ex1-tab-1" data-mdb-toggle="tab" href="{{ url_for('mine.see_my_collection') }}" role="tab" aria-controls="ex1-tabs-1" aria-selected="true">
                            My favorite
                        </a>
                    </li>
                    <li class="nav-item nav-mid shade" role="presentation">
                        <a class="nav-link active" id="ex1-tab-1" data-mdb-toggle="tab" href="{{ url_for('mine.see_my_question') }}" role="tab" aria-controls="ex1-tabs-1" aria-selected="true">
                            My question
                        </a>
                    </li>
                </ul>

                <ul class="question-ul">
                {% for question in questions %}
                    <li>
                        <div class="question-main">
                          <div class="question-title"><a href="{{ url_for('qa.question_detail',question_id=question.id) }}">{{ question.title }}</a></div>
                          <div class="question-content">{{ question.content }}</div>
                          <div class="question-detail">
                              <button type="button" class="btn btn-default" >
                                <i class="bi bi-trash3-fill"  id="btn_delete_icon_{{ question.id }}"></i>
                            </button>
                            <span class="question-time">{{ question.create_time }}</span>
                          </div>
                        </div>
                  </li>
                {% endfor %}
              </ul>
            </div>
        <div class="col"></div>
    </div>
<script>
    {% for question in questions %}
        $("#btn_delete_icon_{{ question.id }}").click(function(){
                //请求参数
                var data = {
                    data: JSON.stringify({
                        q_id:{{ question.id }},
                    }),
                }

                $.ajax({
                    //请求方式
                    type : "POST",
                    dataType: "json",
                    //请求地址
                    url : "http://127.0.0.1:5000/mine/mine/delete_q",
                    //数据，json字符串
                    data : data,
                    //请求成功
                    success : function(result) {
                        location.reload();
                        console.log(result);
                    },
                    //请求失败，包含具体的错误信息
                    error : function(e){
                        console.log(e.status);
                        console.log(e.responseText);
                    }
                });
            });
    {% endfor %}
</script>
{% endblock %}